<!doctype html>
<html>
<head>
    <meta charset="UTF-8">

    <title>Playground 快速原型制作 - CocoaChina_让移动开发更简单</title>
    <meta name="keywords" content="Playground,SwiftiPhone开发,iOS开发,iPad开发,Mac开发,苹果开发中文站,iPhone开发中文站,CocoaChina首页, Mac OS开发, Cocoa介绍,移动互联网,触控科技,Cocoa,Apple,developer,iOS,iPhone,iPad,iMac,iPod Touch,iPhone5,iPhone4S,iPad3,招聘,iPhone程序员,Objective-c,iPhone应用外包,ios6,ios面试,Cocos2d-x,cocos2d,iTunes,App Store,苹果开发" />
    <meta name="description" content="CocoaChina前身是全球成立最早规模最大的苹果开发中文站，现致力为所有移动开发者提供资讯服务、问答服务、代码下载、工具库及人才招聘服务" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="baidu-tc-cerfication" content="3300a939a1098c27e94457b75a0bb8c1" />
    <script type='text/javascript'>
        function gotoMobilePage() {
            var sUserAgent = navigator.userAgent.toLowerCase();
            var agent_iphone = /iphone/i;
            var agent_android = /android/i;
            //var agent_ipad = /ipad/i;
            var agent_ipod = /ipod/i;
            var agent_wphone = /windows phone/i;
            if(agent_iphone.test(sUserAgent) || agent_android.test(sUserAgent) || agent_ipod.test(sUserAgent) || agent_wphone.test(sUserAgent)){
                var re = /\/\w+\/\d+\/(\d+)\.html/, 
                    result = re.exec(window.location.pathname);
                if ( result )
                {
                    window.location.href = "http://www.cocoachina.com/cms/wap.php?action=article&id=" + result[1];
                } else {
                    window.location.href = "http://m.cocoachina.com/";
                }
            }
        }
        gotoMobilePage(); 
    </script>
    <link rel="stylesheet" href="http://cdn.cocimg.com/assets/css/global.css?v=20150818" media="all">
    <link rel="stylesheet" href="http://cdn.cocimg.com/assets/css/index.css?v=20151015" media="all">
    <link href="http://cdn.cocimg.com/assets/css/module.css?v=20150906" rel="stylesheet">
    <link href="http://cdn.cocimg.com/assets/css/style.css?v=620150818" rel="stylesheet">
    <link href="http://cdn.cocimg.com/assets/css/navheader.css?v=20160301" rel="stylesheet" />
    <script src="http://cdn.cocimg.com/assets/js/jquery.min.js?v=20150818" type="text/javascript"></script>
    <script type="text/javascript" src="http://cdn.cocimg.com/assets/js/navbar.js?v=20151013"></script>
    <script type="text/javascript" src="http://s.csbew.com/k.js"></script>
    
</head>
<body>

    <div class="nav-header">
            <div class="nav-header-top">
                <div class="nav-logo nav-fl"><a href="/"><img src="http://cdn.cocimg.com/assets/images/logo.png?v=201510272" /></a></div>
                <div class="nav-list nav-fl">
                    <ul>
                        <li><a href="/news/">资讯</a></li>
                        <li><a href="/bbs/">论坛</a></li>
                        <li><a target="_blank" href="http://code.cocoachina.com/" title="CODE">代码</a></li>
                        <li><a href="http://tools.cocoachina.com" title="工具" target='_blank'>工具</a></li>
                        <li><a target="_blank" href="http://job.cocoachina.com/" title="JOB">招聘</a></li>
                        <li><a target="_blank" href="http://cvp.cocos.com/" title="CVP">CVP</a></li>
                        <li><a target="_blank" href="http://waikuai.cocoachina.com/" title="waikuai">外快</a></li>
                        <li><a target="_blank" href="http://blog.cocoachina.com/" title="blog">博客</a><span class="new-item-flag">new</span></li>
                    </ul>
                </div>
                <div class="nav-search nav-fl">
                    <div class="nav-search-flag" style="display:block"><img src="http://cdn.cocimg.com/assets/img/search-icon.png?v=20150825" /></div>
                    <div class="nav-search-form" style="display:none">
                        <form action="/cms/plus/search.php" name="formsearch" method="post" target="_blank">
                            <input type="hidden" name="kwtype" value="0" />
                            <input type="hidden" name="searchtype" value="titlekeyword" />
                            <input name="keyword" type="text" placeholder="站内搜索" />
                            <input type="button" />
                        </form>
                    </div>
                </div>
                <div class="nav-user nav-fr">
                    <!-- #region 未登录时显示此区域 -->
                    <div class="nav-user-login" style="display:block">
                        <a href="/bbs/login.php">登录</a>|
                        <a href="/bbs/register.php">注册</a>
                    </div>
                    <!-- #endregion -->
                    <!-- #region 已登录时显示此区域 -->
                    <div class="nav-user-name" style="display:none">
                        <div><alert></alert><img src="/assets/img/user.png" />Guest</div>
                        <ul>
                            <li><a href="#"><img src="/assets/img/i-man.png" />我的主页</a></li>
                            <li><alert></alert><a href="#"><img src="/assets/img/i-mail.png" />我的消息</a></li>
                            <li><a href="#"><img src="/assets/img/i-setting.png" />账户设置</a></li>
                            <li><a href="index-offline.html"><img src="/assets/img/i-logout.png" />退出</a></li>
                        </ul>
                    </div>
                    <!-- #endregion -->
                </div>
                <div class="nav-clear"></div>
            </div>
        <div class="nav-header-bottom">
            <ul>
                <li><a id="ios" href="/ios/" title="ios">iOS开发</a></li>
                <li><a id="swift" href="/swift/" title="swift">Swift</a></li>
                <li><a id="app_store" href="/appstore/" title="appstore">App Store研究</a></li>
                <li><a id="design" href="/design/" title="design">产品设计</a></li>
                <li><a id="review" href="/review/" title="review">应用</a></li>
                <li><a id="review" href="/vr/" title="review">VR</a></li>
                <li><a id="game" href="/game/" title="game">游戏开发</a></li>
                <li><a id="apple" href="/apple/" title="apple">苹果相关</a></li>
                <!-- <li><a id="cocos" href="/cocos/" title="cocos">Cocos引擎</a></li>-->
                <!--<li><a id="webapp" href="/webapp/" title="HTML5">HTML5</a></li>-->
                <li><a id="android" href="/android/" title="android">安卓相关</a></li>
                <li><a id="market" href="/market/" title="market">营销推广</a></li>
                <li><a id="industry" href="/industry/" title="industry">业界动态</a></li>
                <li><a id="programmer" href="/programmer/" title="programmer">程序人生</a></li>
            </ul>
        </div>
    </div>

<script language="javascript">
    function IsPC() {
        var userAgentInfo = navigator.userAgent;
        var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPod");
        var flag = true;
        for (var v = 0; v < Agents.length; v++) {
        if (userAgentInfo.indexOf(Agents[v]) > 0) { flag = false; break; }
        }
        return flag;
    }
    if (!IsPC()){
           window.location.href = "http://www.cocoachina.com/cms/wap.php?action=article&id=9771";
    }

</script>
<!--middle-->
<div class="middle clearfix">
    <div class="m-wrap">
        <div class="m-ad2" style="margin-top:12px;">
            <div class="ad2-l">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- CC首页底部左侧72890 -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:728px;height:90px"
                     data-ad-client="ca-pub-1180518835303646"
                     data-ad-slot="8012423965"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            <div class="ad2-r">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- CC资讯页25090 -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:250px;height:90px"
                     data-ad-client="ca-pub-1180518835303646"
                     data-ad-slot="9489157162"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </div>
        <!--left-->
        <div class="detail-left float-l">
            <p class="crumbs"><a href="/" title="首页">首页</a> &gt;</span><a href="/swift" title="Swift"><span id="type_name">Swift</span></a></p>
            <div class="detail-main">
                <h2>Playground 快速原型制作</h2>
                <div class="p-ico clearfix">
                    <div>
                        <span class="ml0">2014-09-27 15:51</span>
                        <span>编辑：
                        <a href="" id="field_author" target="_blank">suiling</a></span>
                        <span>分类：<a href="/swift/" target="_blank">Swift</a></span>
                        <span id="source">来源：<a href="" target="_blank">Objccn</a></span>

                        <div class="float-r">
                            <span id="artical_comment_cnt"><i></i></span>
                            <span><i class="view"></i><script src="/cms/plus/count.php?view=yes&aid=9771&mid=4196" language="javascript"></script></span>
                    </div>
                    </div>
                </div>
                <div class="p-ico clearfix">
                    <p class="related float-l"><a href="/cms/tags.php?/Swift/" target="_blank">Swift</a><a href="/cms/tags.php?/Playground/" target="_blank">Playground</a></p>
                    <input type="hidden" id="article_id"  value="9771"/>
                </div>
                <div class="adsbox clearfix">
                    <div class="float-l">
                        <div class="float-l"><b>招聘信息：</b></div>
                        <ul class="float-l" id="invitelist" style="margin-top: 0px;">
                            <li><a href='http://job.cocoachina.com/job/show?id=68039' target='_blank'>技术合伙人</a></li><li><a href='http://job.cocoachina.com/job/show?id=68040' target='_blank'>移动应用开发项目经理</a></li><li><a href='http://job.cocoachina.com/job/show?id=68231' target='_blank'>iOS开发工程师</a></li><li><a href='http://job.cocoachina.com/job/show?id=68209' target='_blank'>移动APP研发工程师</a></li><li><a href='http://job.cocoachina.com/job/show?id=68164' target='_blank'>产品经理/Product Manager</a></li><li><a href='http://job.cocoachina.com/job/show?id=68175' target='_blank'>Unity开发工程师</a></li><li><a href='http://job.cocoachina.com/job/show?id=68146' target='_blank'>高级iOS工程师</a></li><li><a href='http://job.cocoachina.com/job/show?id=68153' target='_blank'>SDK产品经理</a></li><li><a href='http://job.cocoachina.com/job/show?id=68138' target='_blank'>cocos2d-x游戏开发工程师</a></li><li><a href='http://job.cocoachina.com/job/show?id=68137' target='_blank'>cocos2d-x游戏主程</a></li><li><a href='http://job.cocoachina.com/job/show?id=68136' target='_blank'>cocos2d-x游戏高级开发工程师</a></li>
                            <!--<script src="http://www.cocoachina.com/bbs/new.php?action=article&fidin=26&digest=0&postdate=0&author=0&fname=0&hits=0&replies=0&pre=1&num=3&length=120&order=2" charset="gbk"></script>-->
                        </ul>
                    </div>
                    <div class="float-r">
                        <a href="javascript:void(0)" class="prev"></a>
                        <a href="javascript:void(0)" class="next"></a>
                    </div>
                </div>
                <div id="detailbody" class="field_body">
                    <p>由于使用 Cocoa 框架能够快速地创建一个可用的应用，这让许多开发者都喜欢上了 OS X 或 iOS   开发。如今即使是小团队也能设计和开发复杂的应用，这很大程度上要归功于这些平台所提供的工具和框架。Swift 的 Playground   不仅继承了快速开发的传统，并且有改变我们设计和编写 OS X 和 iOS 应用方式的潜力。</p>
<p>向那些还不熟悉这个概念的读者解释一下，Swift 的 playground 就像是一个可交互的文档，在其中你可以输入 Swift   代码让它们立即编译执行。操作结果随着执行的时间线一步步被展示，开发者能在任何时候输出和监视变量。Playground 既可以在现有的 Xcode   工程中进行创建，也能作为单独的包存在。</p>
<p>Swift 的 playground 主要还是作为学习这门语言的工具而被重视，然而我们只要关注一下类似项目，如 <a href="http://ipython.org">IPython notebooks</a>，就能看到交互编程环境在更广阔的范围内的潜在应用。从<a href="https://github.com/ipython/ipython/wiki/Research-at-UC-Berkeley-using-IPython">科学研究</a>到<a href="http://pyvideo.org/video/1796/simplecv-computer-vision-using-python">机器视觉实验</a>，这些任务现在都使用了 IPython notebooks。这种方式也被用来探索其他语言的范例，如 <a href="https://github.com/gibiansky/IHaskell">Haskell 的函数式编程</a>。</p>
<p>接下来我们将探索 Swift 的 playground 在文档、测试和快速原型方面的用途。本文使用的所有 Swift playground 源码可以在<a href="https://github.com/objcio/PersonalSwiftPlaygrounds">这里下载</a>。</p>
<p><strong>将 Playground 用于文档和测试</strong></p>
<p>Swift 是一个全新的语言，许多人都使用 playground 来了解其语法和约定。不光是语言，Swift 还提供了一个新的标准库。目前这个标准库的文档中对于方法的说明不太详细，所以雨后春笋般的涌现了许多像 <a href="http://practicalswift.com/2014/06/14/the-swift-standard-library-list-of-built-in-functions/">practicalswift.org 标准库方法列表</a>这样的资源。</p>
<p>不过通过文档知道方法的作用是一回事，在代码中实际调用又是另一回事。特别是许多方法在新语言 Swift 的 collection class 中能表现出有趣的特性，因此如果能在 collections 里实际检验它们的作用将非常有帮助。</p>
<p>Playground 展示语法和实时执行真实数据的特性，为编写方法和库接口提供了很好的机会。为了介绍 Collection 方法的使用，我们创建了一个叫 <a href="https://github.com/objcio/PersonalSwiftPlaygrounds">CollectionOperations.playground</a> 的例子，其中包含了一系列 collection 方法的例子，所有的样例数据都能实时修改。</p>
<p>例如，我们创建了如下的初始数组：</p>
<pre><ol class="dp-c"><li class="alt"><span><span>let&nbsp;testArray&nbsp;=&nbsp;[0,&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;4]&nbsp;</span></span></li></ol></pre>
<p>然后想试试 <code>filter()</code> 方法：</p>
<pre><ol class="dp-c"><li class="alt"><span><span>let&nbsp;odds&nbsp;=&nbsp;testArray.filter{$0&nbsp;%&nbsp;2&nbsp;==&nbsp;1}&nbsp;</span></span></li></ol></pre>
<p>最后一行显示这个操作所得到的结果的数组为： <code>[1, 3]</code>。通过实时编译我们能了解语法、写出例子以及获得方法如何使用的说明，所有这些就如一个活的文档展示在眼前。</p>
<p>这对于其他的苹果框架和第三方库都奏效。 例如，你可能想给其他人展示如何使用 Scene Kit，这是苹果提供的一个非常棒的框架，它能在 Mac 和 iOS 上快速构建3D场景。或许你会写一个示例应用，不过这样展示的时候就要构建和编译。</p>
<p>在例子 <a href="https://github.com/objcio/PersonalSwiftPlaygrounds">SceneKitMac.playground</a>   中，我们已经建立了一个功能完备带动画的 3D 场景。你需要打开 Assistant Editor (在菜单上依次点击 View |   Assistant Editor | Show Assistant Editor)，3D   效果和动画将会被自动渲染。这不需要编译循环，而且任何的改动，比如改变颜色、几何形状、亮度等，都能实时反映出来。使用它能在一个交互例子中很好的记录  和介绍如何使用框架。</p>
<p>除了展示方法和方法的操作，你还会注意到通过检查输出的结果，我们可以验证一个方法的执行是否正确，甚至在加载到 playground   的时候就能判断方法是否被正确解析。不难想象我们也可以在 playground   里添加断言，以及创建真正的单元测试。或者更进一步，创建出符合条件的测试，从而在你打字时就实现测试驱动开发。</p>
<p>事实上，在 <a href="http://www.swaine.com/pragpub/">2014 年 7 月号的 PragPub 杂志</a>中，Ron Jeffries 在他的文章 &ldquo;从测试驱动开发角度来看Swift&rdquo; 中提到过这一观点：</p>
<blockquote>
<p><em>Playground 很大程度上会对我们如何执行测试驱动开发产生影响。Playground   能够快速展示我们所能做的东西，因此我们将比之前走得更快。但是同过去的测试驱动开发框架结合在一起时，能否走的更好？我们是否能提炼出更好的代码，以满  足更少的缺陷数量和重构？</em></p>
</blockquote>
<p>关于代码质量的问题还是留给别人回答吧，接下来我们一起来看看 playground 如何加快一个快速原型的开发。</p>
<p><strong>创建 Accelerate 的原型 -- 经过优化的信号处理</strong></p>
<p>Accelerate 框架包括了许多功能强大的并行处理大型数据集的方法。这些方法可以利用例如 Intel 芯片中的 SSE 指令集，或者   ARM 芯片中的 NEON 技术等，这样的现代 CPU   中矢量处理指令的优势。然而，相较于功能的强大，它们的接口似乎有点不透明，其使用的文档也有点缺乏。这就导致许多开发者无法使用 Accelerate   这个强大的工具所带来的优势。</p>
<p>Swift 提供了一个机会，通过方法重载或为 Accelerate 框架进行包装后，可以让交互更加容易。这已经在 Chris Liscio 的库 <a href="https://github.com/liscio/SMUGMath-Swift">SMUGMath</a> 的实践中被证实，这也正是我们接下来将要创建的原型的灵感来源。</p>
<p>假设你有一系列正弦波的数据样本，然后想通过这些数据来确定这个正弦波的频率和幅度，你会怎么做呢？一个解决方案是通过傅里叶变换来算出这些值，傅  里叶变换能从一个或多个重叠的正弦波提取频率和幅度信息。Accelerate 框架提供了另一个解决方案，叫做快速傅里叶变换   （FFT），关于这个方案<a href="http://jakevdp.github.io/blog/2013/08/28/understanding-the-fft/">这里</a>有一个 (基于 IPython notebook 的) 很好的解释。</p>
<p>我们在例子 <a href="https://github.com/objcio/PersonalSwiftPlaygrounds">AccelerateFunctions.playground</a> 中实现了这个原型，你可以对照这个例子来看下面的内容。请确认你已经打开 Assistant Editor (在菜单上依次点击 View | Assistant Editor | Show Assistant Editor) 以查看每一阶段所产生的图形。</p>
<p>首先我们要产生一些用于实验的示例波形。使用 Swift 的 <code>map()</code> 方法可以很容易地实现：</p>
<pre><ol class="dp-c"><li class="alt"><span><span>let&nbsp;sineArraySize&nbsp;=&nbsp;64&nbsp;</span></span></li><li><span>&nbsp;</span></li><li class="alt"><span>let&nbsp;frequency1&nbsp;=&nbsp;4.0&nbsp;</span></li><li><span>let&nbsp;phase1&nbsp;=&nbsp;0.0&nbsp;</span></li><li class="alt"><span>let&nbsp;amplitude1&nbsp;=&nbsp;2.0&nbsp;</span></li><li><span>let&nbsp;sineWave&nbsp;=&nbsp;(0..<sineArraySize).map&nbsp;{&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;amplitude1&nbsp;*&nbsp;sin(2.0&nbsp;*&nbsp;M_PI&nbsp;/&nbsp;Double(sineArraySize)&nbsp;*&nbsp;Double($0)&nbsp;*&nbsp;frequency1&nbsp;+&nbsp;phase1)&nbsp;</span></li><li><span>}&nbsp;</span></li></ol></pre>
<p>为了便于之后使用 FFT，我们的初始数组大小必须是 2 的幂次方。把 <code>sineArraySize</code> 值改为像 32，128 或 256 将改变之后显示的图像的密度，但它不会改变计算的基本结果。</p>
<p>要绘制我们的波形，我们将使用新的 XCPlayground 框架 (需要先导入) 和以下辅助函数：</p>
<pre><ol class="dp-c"><li class="alt"><span><span>func&nbsp;plotArrayInPlayground<T>(arrayToPlot:Array<T>,&nbsp;title:String)&nbsp;{&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;currentValue&nbsp;</span><span class="keyword">in</span><span>&nbsp;arrayToPlot&nbsp;{&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XCPCaptureValue(title,&nbsp;currentValue)&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span></li><li class="alt"><span>}&nbsp;</span></li></ol></pre>
<p>当我们执行：</p>
<pre><ol class="dp-c"><li class="alt"><span><span>plotArrayInPlayground(sineWave,&nbsp;</span><span class="string">"Sine&nbsp;wave&nbsp;1"</span><span>)&nbsp;</span></span></li></ol></pre>
<p>我们可以看到如下所示的图表：</p>
<div style="text-align: center;"><img width="495" height="257" border="0" style="cursor: pointer;" alt="" src="/cms/uploads/allimg/140927/4196_140927155817_1.png" /></div>
<p>这是一个频率为 4.0、振幅为 2.0、相位为 0 的正弦波。为了变得更有趣一些，我们创建了第二个正弦波，它的频率为 1.0、振幅为 1.0、相位为 &pi;/2，然后把它叠加到第一个正弦波上：</p>
<pre><ol class="dp-c"><li class="alt"><span><span>let&nbsp;frequency2&nbsp;=&nbsp;1.0&nbsp;</span></span></li><li><span>let&nbsp;phase2&nbsp;=&nbsp;M_PI&nbsp;/&nbsp;2.0&nbsp;</span></li><li class="alt"><span>let&nbsp;amplitude2&nbsp;=&nbsp;1.0&nbsp;</span></li><li><span>let&nbsp;sineWave2&nbsp;=&nbsp;(0..<sineArraySize).map&nbsp;{&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;amplitude2&nbsp;*&nbsp;sin(2.0&nbsp;*&nbsp;M_PI&nbsp;/&nbsp;Double(sineArraySize)&nbsp;*&nbsp;Double($0)&nbsp;*&nbsp;frequency2&nbsp;+&nbsp;phase2)&nbsp;</span></li><li><span>}&nbsp;</span></li></ol></pre>
<p>&nbsp;</p>
<div style="text-align: center;"><img width="523" height="270" border="0" src="/cms/uploads/allimg/140927/4196_140927160001_1.png" alt="" style="cursor: pointer;" /></div>
<p>&nbsp;现在我们要将两个波叠加。从这里开始 Accelerate 将帮助我们完成工作。将两个个独立地浮点数数组相加非常适进行合并行处理。这里我们要使用到  Accelerate 的 vDSP 库，它正好有这类功能的方法。为了让这一切更有趣，我们将重载一个 Swift 操作符用于向量叠加。不巧的是 <code>+</code> 这个操作符已经用于数组连接 (其实挺容易混淆的)，而 <code>++</code> 更适合作为递增运算符，因此我们将定义 <code>+++</code> 作为相加的运算符。</p>
<pre><ol class="dp-c"><li class="alt"><span><span>infix&nbsp;operator&nbsp;&nbsp;+++&nbsp;{}&nbsp;</span></span></li><li><span>func&nbsp;+++&nbsp;(a:&nbsp;[Double],&nbsp;b:&nbsp;[Double])&nbsp;->&nbsp;[Double]&nbsp;{&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;assert(a.count&nbsp;==&nbsp;b.count,&nbsp;<span class="string">"Expected&nbsp;arrays&nbsp;of&nbsp;the&nbsp;same&nbsp;length,&nbsp;instead&nbsp;got&nbsp;arrays&nbsp;of&nbsp;two&nbsp;different&nbsp;lengths"</span><span>)&nbsp;</span></span></li><li><span>&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">var</span><span>&nbsp;result&nbsp;=&nbsp;[Double](count:a.count,&nbsp;repeatedValue:0.0)&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;vDSP_vaddD(a,&nbsp;1,&nbsp;b,&nbsp;1,&nbsp;&result,&nbsp;1,&nbsp;UInt(a.count))&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;result&nbsp;</span></span></li><li><span>}&nbsp;</span></li></ol></pre>
<p>上文定义了一个操作符，操作符能将两个 <code>Double</code> 类型的 Swift 数组中的元素依次合并为一个数组。在运算中创建了一个和输入的数组长度相等的空白数组（假设输入的两个数组长度相等）。由于 Swift 的一维数组可以直接映射成 C 语言的数组，因此我们只需要将作为参数的 <code>Doubles</code> 类型数组直接传递给 <code>vDSP_vaddD()</code> 方法，并在我们的数组结果前加前缀 <code>&</code>。</p>
<p>为了验证上述叠加是否被正确执行，我们可以使用 for 循环以及 Accelerate 方法来绘制合并后的正弦波的结果：</p>
<pre><ol class="dp-c"><li class="alt"><span><span class="keyword">var</span><span>&nbsp;combinedSineWave&nbsp;=&nbsp;[Double](count:sineArraySize,&nbsp;repeatedValue:0.0)&nbsp;</span></span></li><li><span><span class="keyword">for</span><span>&nbsp;currentIndex&nbsp;</span><span class="keyword">in</span><span>&nbsp;0..<sineArraySize&nbsp;{&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;combinedSineWave[currentIndex]&nbsp;=&nbsp;sineWave[currentIndex]&nbsp;+&nbsp;sineWave2[currentIndex]&nbsp;</span></li><li><span>}&nbsp;</span></li><li class="alt"><span>&nbsp;</span></li><li><span>let&nbsp;combinedSineWave2&nbsp;=&nbsp;sineWave&nbsp;+++&nbsp;sineWave2&nbsp;</span></li><li class="alt"><span>&nbsp;</span></li><li><span>plotArrayInPlayground(combinedSineWave,&nbsp;<span class="string">"Combined&nbsp;wave&nbsp;(loop&nbsp;addition)"</span><span>)&nbsp;</span></span></li><li class="alt"><span>plotArrayInPlayground(combinedSineWave2,&nbsp;<span class="string">"Combined&nbsp;wave&nbsp;(Accelerate)"</span><span>)&nbsp;</span></span></li></ol></pre>
<p>&nbsp;</p>
<div style="text-align: center;"><img width="492" height="516" border="0" style="cursor: pointer;" alt="" src="http://www.cocoachina.com/cms/uploads/allimg/140927/4196_140927160208_1.jpg" /></div>
<p>果然，结果是一致的。</p>
<p>在继续 FFT 本身之前，我们需要另一个向量运算来处理计算的结果。Accelerate 的 FFT 实现中获取的所有结果都是平方之后的，所以我们需要对它们做平方根操作。我们需要对数组中的所有元素调用类似 <code>sqrt()</code> 方法，这听上去又是一个使用 Accelerate 的机会。</p>
<p>Accelerate 的 vecLib 库中有很多等价的数学方法，包括平方根的 <code>vvsqrt()</code>。这是个使用方法重载的好例子，让我们来创建一个新版本的 <code>sqrt()</code>，使其能处理 <code>Double</code> 类型的数组。</p>
<pre><ol class="dp-c"><li class="alt"><span><span>func&nbsp;sqrt(x:&nbsp;[Double])&nbsp;->&nbsp;[Double]&nbsp;{&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">var</span><span>&nbsp;results&nbsp;=&nbsp;[Double](count:x.count,&nbsp;repeatedValue:0.0)&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vvsqrt(&results,&nbsp;x,&nbsp;[Int32(x.count)])&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;results&nbsp;</span></span></li><li class="alt"><span>}&nbsp;</span></li></ol></pre>
<p>和我们的叠加运算符一样，重载的平方函数输入一个 <code>Double</code> 数组，为输出创建了一个 <code>Double</code> 类型的数组，并将输入数组中的所有参数直接传递给 Accelerate 中的 <code>vvsqrt()</code>。通过在 playground 中输入以下代码，我们可以验证刚刚重载的方法。</p>
<pre><ol class="dp-c"><li class="alt"><span><span>sqrt(4.0)&nbsp;</span></span></li><li><span>sqrt([4.0,&nbsp;3.0,&nbsp;16.0])&nbsp;</span></li></ol></pre>
<p>我们能看到，标准 <code>sqrt()</code> 函数返回2.0，而我们的新建的重载方法返回了 [2.0, 1.73205080756888, 4.0]。这的确是一个非常易用的重载方法，你甚至可以想象照以上方法使用 vecLib 为所有的数学方法写一个并行的版本 (不过 Mattt Thompson <a href="https://github.com/mattt/Surge">已经做了这件事</a>)。在一台 15 寸的 2012 年中的 i7 版本 MacBook Pro 中处理一个有一亿个元素的数组，使用基于 Accelerate 的 <code>sqrt()</code> 方法的运行速度比迭代使用普通的一维 <code>sqrt()</code> 快将近一倍。</p>
<p>有了这个以后，我们来实现 FFT。我们并不打算在 FFT 设置的细节上花费大量时间，以下是我们的 FFT 方法：</p>
<pre><ol class="dp-c"><li class="alt"><span><span>let&nbsp;fft_weights:&nbsp;FFTSetupD&nbsp;=&nbsp;vDSP_create_fftsetupD(vDSP_Length(log2(Float(sineArraySize))),&nbsp;FFTRadix(kFFTRadix2))&nbsp;</span></span></li><li><span>&nbsp;</span></li><li class="alt"><span>func&nbsp;fft(<span class="keyword">var</span><span>&nbsp;inputArray:[Double])&nbsp;->&nbsp;[Double]&nbsp;{&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">var</span><span>&nbsp;fftMagnitudes&nbsp;=&nbsp;[Double](count:inputArray.count,&nbsp;repeatedValue:0.0)&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">var</span><span>&nbsp;zeroArray&nbsp;=&nbsp;[Double](count:inputArray.count,&nbsp;repeatedValue:0.0)&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">var</span><span>&nbsp;splitComplexInput&nbsp;=&nbsp;DSPDoubleSplitComplex(realp:&nbsp;&inputArray,&nbsp;imagp:&nbsp;&zeroArray)&nbsp;</span></span></li><li class="alt"><span>&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;vDSP_fft_zipD(fft_weights,&nbsp;&splitComplexInput,&nbsp;1,&nbsp;vDSP_Length(log2(CDouble(inputArray.count))),&nbsp;FFTDirection(FFT_FORWARD));&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;vDSP_zvmagsD(&splitComplexInput,&nbsp;1,&nbsp;&fftMagnitudes,&nbsp;1,&nbsp;vDSP_Length(inputArray.count));&nbsp;</span></li><li><span>&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;roots&nbsp;=&nbsp;sqrt(fftMagnitudes)&nbsp;<span class="comment">//&nbsp;vDSP_zvmagsD&nbsp;returns&nbsp;squares&nbsp;of&nbsp;the&nbsp;FFT&nbsp;magnitudes,&nbsp;so&nbsp;take&nbsp;the&nbsp;root&nbsp;here</span><span>&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">var</span><span>&nbsp;normalizedValues&nbsp;=&nbsp;[Double](count:inputArray.count,&nbsp;repeatedValue:0.0)&nbsp;</span></span></li><li class="alt"><span>&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;vDSP_vsmulD(roots,&nbsp;vDSP_Stride(1),&nbsp;[2.0&nbsp;/&nbsp;Double(inputArray.count)],&nbsp;&normalizedValues,&nbsp;vDSP_Stride(1),&nbsp;vDSP_Length(inputArray.count))&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;normalizedValues&nbsp;</span></span></li><li><span>}&nbsp;</span></li></ol></pre>
<p>第一步，我们设置了计算中需要使用到的 FFT 权重，它和我们要处理的数组大小相关。这些权重将在稍后实际的 FFT 计算中被使用到，它可以通过 <code>vDSP_create_fftsetupD()</code> 计算得到，并且对于给定大小的数组是可以重用的。因为在这里数组的大小是个恒定的常量，因此我们只需要计算一次权重，并将它作为全局变量并在每次 FFT 中重用即可。</p>
<p>在 FFT 方法中，我们初始化了一个用于存放操作结果的数组 <code>fftMagnitudes</code>，数组的初始元素都为 0，大小为之前正弦波的大小。FFT 运算的输入参数都是实部加上虚部的复数形式，但我们真正关心的只是它的实数部分，因此我们初始化 <code>splitComplexInput</code> 的时候使用输入数组作为实数部分，而将零作为虚数部分。然后 <code>vDSP_fft_zipD()</code> 和 <code>vDSP_zvmagsD()</code> 负责执行 FFT，并使用 <code>fftMagnitudes</code> 数组来存储 FFT 从  FFT 中得到的结果的平方数。</p>
<p>在这里，我们使用了之前提到的基于 Accelerate 的 <code>sqrt()</code> 方法来计算平方根，返回实际大小，然后基于输入数组的大小对值进行归一化。</p>
<p>对一个单一的正弦波，以上所有操作的的结果如下：</p>
<div style="text-align: center;"><img width="494" height="519" border="0" style="cursor: pointer;" alt="" src="http://www.cocoachina.com/cms/uploads/allimg/140927/4196_140927160446_1.jpg" /></div>
<p>叠加的正弦波看起来像这样：</p>
<div style="text-align: center;"><img width="492" height="258" border="0" style="cursor: pointer;" alt="" src="http://www.cocoachina.com/cms/uploads/allimg/140927/4196_140927160527_1.jpg" /></div>
<p>对这些值一个非常简单的解释是：这些结果表示了正弦波频率的集合，从左边开始，集合中的值表示了在该频率下检测到的波的振幅。它们关于中心对称，因此你可以忽略图中右半部分的值。</p>
<p>可以观察到对于频率为 4.0 振幅为 2.0 的波，在 FFT 中是一个 位于 4 对应于 2.0 的值。同样对于频率为 1.0 振幅为  1.0 的波，在 FFT 中是位于 1 对应值为 1.0 的点。尽管叠加后的正弦波得到的 FFT  波形比较复杂，但是依然能够清晰地区分合并的两个波在各自集合内的振幅和频率，就仿佛它们的 FFT 结果是分别被加入的一样。</p>
<p>再次强调，这是 FFT 运算的简化版本，在上文的 FFT 代码中有简化操作，但关键是在 playground 中通过一步步创建方法，我们能轻松地探索一个复杂的信号处理操作，并且每一步操作的测试都能立即得到图形反馈。</p>
<p><strong>使用 Swift Playgrounds 快速创建原型的案例</strong></p>
<p>我们希望这些例子能够说明 Swift playground 在实践新类库和新概念上的作用。</p>
<p>上一个例子中的每一步里，我们都能在执行时通过时间线中的图案来观察中间数组的状态。这对于一个示例程序来说作用非常大，而且也以某种方式为程序提 供了界面。所有这些图像都实时更新，因此你能随时返回到实现中并修改其中一个波的频率或振幅，然后看着波形随着处理步骤变化。这缩短了开发周期，并且对计 算过程的体验提供了巨大帮助。</p>
<p>这种立即反馈的交互式开发是为复杂的算法创建原型的很好的案例。在将这样的复杂算法部署到实际的应用之前，我们有机会在 playground 中对它进行验证和研究。</p>
<p>（文章来源：<a href="http://objccn.io/issue-16-5/" target="_blank">objc中国</a>）</p>
                </div>
                <div id="page" style="padding:0"></div>

                <div class="wx_article">
                    <div class="article_weixin">
                        <img src="http://cdn.cocimg.com/cms/templets/images/article_weixin.jpg" width="131" height="131" alt="搜索CocoaChina微信公众号：CocoaChina"/>
                        <div class="article_scan">微信扫一扫</div>
                        <div class="article_txt" ><span style="color:#999999">订阅每日移动开发及APP推广热点资讯<br/>公众号：</span>CocoaChina</div>
                    </div>
                </div>

               <div class="clearfix tgbox">
                    <a href="http://www.cocoachina.com/deliver.php" class="tg float-l" target="_blank">我要投稿</a>&nbsp;&nbsp;
                    <a style="margin-left:10px"  href="javascript:void(0)" onClick="add_favors(9771,'Playground 快速原型制作')" class="tg float-l" >收藏文章</a>
                    <div class="share float-r">分享到：
                        <div class="bdsharebuttonbox" id="sharediv"><a href="#" class="bds_more" data-cmd="more"></a> <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a> <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a></div>
                    </div>
                </div>


                <a class="zanbox" href="javascript:void(0)" id="zanbox" onClick="postDigg('good',9771)" title="哎呦，不错噢，赞一个" >
                    <strong id="newdigg">
                     <script src="/cms/plus/count.php?view=yes&digg_id=9771&mid=4196" language="javascript"></script>
                    </strong>
                </a>
            </div>

            <div class="article-prev">上一篇：<a href='/swift/20140910/9571.html'>Swift更新至1.0版本</a> </div>
            <div class="article-next">下一篇：<a href='/swift/20140927/9772.html'>Swift 命令行工具</a> </div>

            <!--相关资讯-->
            <div class="part-wrap clearfix">
                <h3>相关资讯</h3>
                <ul class="info-list clearfix">
                    <li>
                        <a href="/swift/20161020/17805.html" target="_blank" title="之前在OC开发中习惯了AFN的各种便捷操作，到了Swift中各种想办法解决数据请求和解析问题。百思不得解，终于找到了Alamofire这个第三方库，但是这个库在普通引用上与OC的直接引用有所不同，但是使用">Alamofire4.0踩坑</a>
                     </li>
<li>
                        <a href="/swift/20161020/17802.html" target="_blank" title="C语言的指针操作
在c语言中申明一个变量并通过指针修改该变量的值">Swift结构体指针操作</a>
                     </li>
<li>
                        <a href="/swift/20161019/17796.html" target="_blank" title="根据Swift官方文档，闭包（closure）会自动捕捉其所在上下文中的外部变量，即使是定义这些变量的上下文已经消失。寥寥数字，其实已经将闭包捕捉说的足够清晰明了，只是其中隐含的诸如捕捉的具体">闭包捕捉(closure capture)浅析</a>
                     </li>
<li>
                        <a href="/swift/20161019/17795.html" target="_blank" title="首先我们先创建两个视图控制器ViewController.swift和SubViewController.swift">一篇文章学会页面传值的10种方法(上)</a>
                     </li>
<li>
                        <a href="/swift/20161018/17783.html" target="_blank" title="基于Swift写一个小轮子，使用微博的表情素材，简单友好的生成属性文本写下此篇，记录其中的知识点">Swift3.0图文混排进阶（一）数据准备</a>
                     </li>
<li>
                        <a href="/swift/20161014/17758.html" target="_blank" title="基于对代码质量和排名的考量标准，Mybridge AI从900个用Swift编写的开源APP中甄选了21个项目推荐给开发者（不包括开源库）。">21个高质量的Swift开源iOS App</a>
                     </li>
<li>
                        <a href="/swift/20161013/17736.html" target="_blank" title="Swift 3.0 正式版发布了差不多快一个月了，断断续续的把手上和 Swift 相关的迁移到了Swift 3.0。所以写点小总结。">Swift 3 迁移工作总结</a>
                     </li>
<li>
                        <a href="/swift/20161011/17714.html" target="_blank" title="学习Swift这门新语言快一个多月了，对于熟练掌握OC编程的iOS开发者来说其实很容易上手，但Swift的确在语法和编程习惯上改变了很多，对于从未了解OC语言而从Swift开始学习iOS开发的新手来说可能上手有">Swift中的变量和常量</a>
                     </li>
<li>
                        <a href="/swift/20161010/17713.html" target="_blank" title="什么是多代理
用过环信SDK的同学应该对多代理不陌生了，请看下面代码">Swift3实现多代理</a>
                     </li>
<li>
                        <a href="/swift/20161010/17711.html" target="_blank" title="JSON是移动端开发常用的应用层数据交换协议。最常见的场景便是，客户端向服务端发起网络请求，服务端返回JSON文本，然后客户端解析这个JSON文本，再把对应数据展现到页面上。">在Swift语言中处理JSON - 转换JSON和Model</a>
                     </li>

                </ul>
            </div>
            <div class="clearfix" style="margin-top:20px;" >
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- CC评论框 -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:750px;height:90px"
                     data-ad-client="ca-pub-1180518835303646"
                     data-ad-slot="8242010366"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            <!-- 评论模块start -->
            
            <div class="clearfix" id="commnet_list_holder" style="margin-bottom:50px;">
                <div class="glab-comment-form">
                    <div class="dcbt">我来说两句</div>
                    <div class="user-head">
                        <img id="user_face_url" src="http://cdn.cocimg.com/bbs/images/face/none.gif" height="43" width="43" alt="">
                    </div>
                    <div class="form-region">
                        <textarea name="comment" id="main_comment_content" cols="30" rows="10" placeholder="你怎么看？快来评论一下吧！"></textarea>
                        <a class="submitform" id="main_comment_bt">发表评论</a>
                        <div class="unlogin-mask">
                            <div>您还没有登录！请<a href="/bbs/login.php">登录</a>或<a href="/bbs/register.php">注册</a></div>
                        </div>
                    </div>
                </div>
                <div id="glab-comment-callback-msg" class="glab-comment-info"></div>
                <div class="glab-comment-title">所有评论（<span>0</span>）</div>
                <div class="glab-commentlist" id="commentlist">
                    <a id="refresh_comment_btn" href="javascript:;" onclick="$('#morecomment').trigger('click')">刷新评论</a>
                </div>
                <div class="glab-comment-more" id="morecomment" style="display:none">
                    更多评论
                </div>
            </div>
            
            <!-- 评论模块end -->


        </div>
        <!--./left-->
        <!--侧边栏-->
        <div class="clearfix newslist">
            <div class="rightSide detail-right float-r"  >
                <!--两周热门资讯推荐-->
                <div>
                    <div class="part-wrap clearfix">
                        <h3>热门资讯</h3>
                        <ul class="related-hot">
                            <li class="clearfix"><a href="http://www.cocoachina.com/ios/20161024/17830.html" class="float-l pic" target="_blank" title="Xcode 8带来的新特性和坑"><img src="http://cc.cocimg.com/api/uploads/161024/e974214a4770ba8d3810a5b229e45432.jpg"  style="max-height:60px" alt="Xcode 8带来的新特性和坑"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20161024/17830.html" target="_blank" title="Xcode 8带来的新特性和坑">Xcode 8带来的新特性和坑</a></p><p class="hits">点击量<span>19405</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20161026/17850.html" class="float-l pic" target="_blank" title="iOS项目分析及优化"><img src="http://cc.cocimg.com/api/uploads/161025/1f0408f7572cd06600bf05d9f6711461.jpg"  style="max-height:60px" alt="iOS项目分析及优化"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20161026/17850.html" target="_blank" title="iOS项目分析及优化">iOS项目分析及优化</a></p><p class="hits">点击量<span>7439</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20161018/17778.html" class="float-l pic" target="_blank" title="谈UIView Animation编程艺术"><img src="http://cc.cocimg.com/api/uploads/161017/a88a4c13e62b47749d25bc1b99869161.jpg"  style="max-height:60px" alt="谈UIView Animation编程艺术"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20161018/17778.html" target="_blank" title="谈UIView Animation编程艺术">谈UIView Animation编程艺术</a></p><p class="hits">点击量<span>6110</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20161025/17849.html" class="float-l pic" target="_blank" title="做一个 App 前需要考虑的几件事"><img src="http://cc.cocimg.com/api/uploads/161025/0c26b4e53ef8684ce2d19b6e47d376fa.jpg"  style="max-height:60px" alt="做一个 App 前需要考虑的几件事"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20161025/17849.html" target="_blank" title="做一个 App 前需要考虑的几件事">做一个 App 前需要考虑的几件事</a></p><p class="hits">点击量<span>5863</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/industry/20161018/17777.html" class="float-l pic" target="_blank" title="不一样的角度 解读微信小程序"><img src="http://cc.cocimg.com/api/uploads/161017/4f2c99f1f6278abd112b384b4e819d3f.jpg"  style="max-height:60px" alt="不一样的角度 解读微信小程序"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/industry/20161018/17777.html" target="_blank" title="不一样的角度 解读微信小程序">不一样的角度 解读微信小程序</a></p><p class="hits">点击量<span>5107</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/apple/20161021/17821.html" class="float-l pic" target="_blank" title="苹果确认Macbook Pro 2016发布时间"><img src="http://cc.cocimg.com/api/uploads/161021/f5958d2fe5b05665d882b2957988584f.jpg"  style="max-height:60px" alt="苹果确认Macbook Pro 2016发布时间"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/apple/20161021/17821.html" target="_blank" title="苹果确认Macbook Pro 2016发布时间">苹果确认Macbook Pro 2016发布时间</a></p><p class="hits">点击量<span>4891</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/apple/20161028/17878.html" class="float-l pic" target="_blank" title="一触即发：MacBook Pro全新阵容亮相"><img src="http://cc.cocimg.com/api/uploads/161028/88843c8e71249d041a8bfcd108e419eb.png"  style="max-height:60px" alt="一触即发：MacBook Pro全新阵容亮相"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/apple/20161028/17878.html" target="_blank" title="一触即发：MacBook Pro全新阵容亮相">一触即发：MacBook Pro全新阵容亮相</a></p><p class="hits">点击量<span>4771</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20161021/17820.html" class="float-l pic" target="_blank" title="iOS10推送必看UNNotificationContentExtension"><img src="http://cc.cocimg.com/api/uploads/161021/5db270796c0a2648872279c9c44c196f.jpg"  style="max-height:60px" alt="iOS10推送必看UNNotificationContentExtension"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20161021/17820.html" target="_blank" title="iOS10推送必看UNNotificationContentExtension">iOS10推送必看UNNotificationContentExtension</a></p><p class="hits">点击量<span>4036</span></p></div></li><li class="clearfix"><a href="http://www.cocoachina.com/ios/20161018/17780.html" class="float-l pic" target="_blank" title="一款Xcode合法插件EasyCode，快速生成代码"><img src="http://cc.cocimg.com/api/uploads/161017/32ec6be77030ab34612cfeeddf4cb81a.jpg"  style="max-height:60px" alt="一款Xcode合法插件EasyCode，快速生成代码"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20161018/17780.html" target="_blank" title="一款Xcode合法插件EasyCode，快速生成代码">一款Xcode合法插件EasyCode，快速生成代码</a></p><p class="hits">点击量<span>3875</span></p></div></li><li class="clearfix noborder-b"><a href="http://www.cocoachina.com/ios/20161018/17785.html" class="float-l pic" target="_blank" title="开发只懂 AFN ？搞定 NSURLSession 才是硬道理"><img src="http://cc.cocimg.com/api/uploads/161017/58e373ee5093006c0640d4915634c237.jpg"  style="max-height:60px" alt="开发只懂 AFN ？搞定 NSURLSession 才是硬道理"/></a><div style="margin-left:86px"><p class="related-intro"><a href="http://www.cocoachina.com/ios/20161018/17785.html" target="_blank" title="开发只懂 AFN ？搞定 NSURLSession 才是硬道理">开发只懂 AFN ？搞定 NSURLSession 才是硬道理</a></p><p class="hits">点击量<span>3755</span></p></div></li>
                        </ul>
                    </div>
               </div>
               <!--./两周热门资讯推荐-->
               <!--综合评论-->
                <div class="part-wrap clearfix" style="margin-top: 15px;">
                    <h3>综合评论</h3>
                    <ul class="related-comment clearfix" id="all_comments_holder">
                        <li><span class="hide_comment">1</span><br/><p><span>创蓝短信验证码平台</span><span>评论了</span><a href="http://www.cocoachina.com/programmer/20161101/17901.html" title="2016年末闲谈iOS开发的未来" target="_blank" ><span>2016年末闲谈iOS开发的未来</span></a></p></li><li><span class="hide_comment">壁纸是越做越丑<br></span><br/><p><span>sky毒药</span><span>评论了</span><a href="http://www.cocoachina.com/apple/20161101/17904.html" title="iOS 10.2首个测试版新功能一览" target="_blank" ><span>iOS 10.2首个测试版新功能一览</span></a></p></li><li><span class="hide_comment">厉害了666</span><br/><p><span>qiager</span><span>评论了</span><a href="http://www.cocoachina.com/ios/20161031/17890.html" title="你的商城缺筛选侧边栏吗？都给你做好了" target="_blank" ><span>你的商城缺筛选侧边栏吗？都给你做好了</span></a></p></li><li><span class="hide_comment">转载请注明出处。微博@大朕东，简书@大朕东</span><br/><p><span>大朕东</span><span>评论了</span><a href="http://www.cocoachina.com/ios/20161031/17891.html" title="服务端 Swift - Vapor 篇 （一）" target="_blank" ><span>服务端 Swift - Vapor 篇 （一）</span></a></p></li><li><span class="hide_comment">个人觉得很不错，希望持续更新</span><br/><p><span>画船听雨眠</span><span>评论了</span><a href="http://www.cocoachina.com/ios/20161018/17780.html" title="一款Xcode合法插件EasyCode，快速生成代..." target="_blank" ><span>一款Xcode合法插件EasyCode，快速生成代...</span></a></p></li><li><span class="hide_comment">666</span><br/><p><span>qq240066285</span><span>评论了</span><a href="http://www.cocoachina.com/programmer/20161101/17901.html" title="2016年末闲谈iOS开发的未来" target="_blank" ><span>2016年末闲谈iOS开发的未来</span></a></p></li><li><span class="hide_comment">我擦，&nbsp;这尼玛买线还得几把块，价格涨了3k多，有点夸张啊</span><br/><p><span>petsatan</span><span>评论了</span><a href="http://www.cocoachina.com/apple/20161031/17893.html" title="苹果MBP接口太超前 理想主义总要付点代价" target="_blank" ><span>苹果MBP接口太超前 理想主义总要付点代价</span></a></p></li><li><span class="hide_comment">1.没有magicSafe是不是脑残了，2.没有usb口不是搞笑了，到哪都要搞转接口.3.你把耳机口放上面是几个意思？不是SB吗，用户的线放在上面接着很方便吗？</span><br/><p><span>残痕</span><span>评论了</span><a href="http://www.cocoachina.com/apple/20161031/17893.html" title="苹果MBP接口太超前 理想主义总要付点代价" target="_blank" ><span>苹果MBP接口太超前 理想主义总要付点代价</span></a></p></li><li><span class="hide_comment">珠海中亿网络科技有限公司，我们提供专业的ios冲榜、ASO、评论优化服务，用户苹果ID权重高，效果显著，欢迎前来咨询洽谈QQ115074679</span><br/><p><span>hager</span><span>评论了</span><a href="http://www.cocoachina.com/appstore/20160112/14943.html" title="当搜索联想词重出江湖，我们又该如何把握ASO的"风..." target="_blank" ><span>当搜索联想词重出江湖，我们又该如何把握ASO的"风...</span></a></p></li><li class="noborder-b"><span class="hide_comment">珠海中亿网络科技有限公司，我们提供专业的ios冲榜、ASO、评论优化服务，用户苹果ID权重高，效果显著，欢迎前来咨询洽谈QQ115074679</span><br/><p><span>hager</span><span>评论了</span><a href="http://www.cocoachina.com/appstore/20160602/16575.html" title="执着金牛，在理想和现实间游走 - ASO其它系列之..." target="_blank" ><span>执着金牛，在理想和现实间游走 - ASO其它系列之...</span></a></p></li>
                    </ul>
                </div>
                <!--./综合评论-->
                <!--相关帖子-->
                <div class="part-wrap clearfix" style="margin:15px 0 15px 0;">
                    <h3>相关帖子</h3>
                    <ul class="related-comment clearfix">
                        <script charset="gb2312" src="http://www.cocoachina.com/bbs/new.php?action=article&fidin=21_18_2_8_19_41_59_48_56_14_36_5&digest=0&postdate=0&author=0&fname=0&hits=0&replies=0&pre=0&num=10&length=100&order=2&like=ios#Swift"></script>
                    </ul>
                </div>
                <!--./相关帖子-->
                <iframe width="230" height="550" class="share_self" frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=230&height=550&fansRow=2&ptype=1&speed=0&skin=5&isTitle=1&noborder=1&isWeibo=1&isFans=0&uid=1659808677&verifier=6043be56&dpc=1"></iframe>
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- CC列表页面230x230 -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:230px;height:230px"
                     data-ad-client="ca-pub-1180518835303646"
                     data-ad-slot="6765277166"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </div>
        <!--./侧边栏-->
    </div>

    <div id="coco-store" style="display:none">
        <div class="storebox">
            <h5>提示</h5>
            <h3>已经收藏该篇文章</h3>
            <p class="p1"><a href="/bbs/u.php?action=favor&tag=1" target="_blank">去我的收藏夹</a></p>
            <p class="p2"><a href="/bbs/login.php">请登录</a></p>
        </div>
    </div> <!--收藏提示-->
</div>

<script type="text/javascript">

function postDigg(ftype,aid)
{
    var taget_obj = document.getElementById('newdigg');
    var saveid = GetCookie('diggid');
    if(saveid != null)
    {
        var saveids = saveid.split(',');
        var hasid = false;
        saveid = '';
        j = 1;
        for(i=saveids.length-1;i>=0;i--)
        {
            if(saveids[i]==aid && hasid) continue;
            else {
                if(saveids[i]==aid && !hasid) hasid = true;
                saveid += (saveid=='' ? saveids[i] : ','+saveids[i]);
                j++;
                if(j==20 && hasid) break;
                if(j==19 && !hasid) break;
            }
        }
        if(hasid) { alert("您已经顶过该帖，请不要重复顶帖 ！"); return; }
        else saveid += ','+aid;
        SetCookie('diggid',saveid,1);
    }
    else
    {
        SetCookie('diggid',aid,1);
    }
    myajax = new DedeAjax(taget_obj,false,false,'','','');
    var url = "/cms/plus/digg_ajax.php?action="+ftype+"&id="+aid;
    myajax.SendGet2(url);
    DedeXHTTP = null;
    $('#zanbox').addClass('zanbox-selected');
}
function getDigg(aid)
{
    var taget_obj = document.getElementById('newdigg');
    myajax = new DedeAjax(taget_obj,false,false,'','','');
    myajax.SendGet2("/cms/plus/digg_ajax.php?id="+aid);
    DedeXHTTP = null;
}


//显示对应的导航：
$(function(){
    var article_id = $('#article_id').val();
    var saveid = GetCookie('diggid');

    if(saveid != null)
    {
        var saveids = saveid.split(',');
        var hasid = false;
        saveid = '';
        j = 1;
        for(i=saveids.length-1;i>=0;i--)
        {
            if(saveids[i]==article_id && hasid) continue;
            else {
                if(saveids[i]==article_id && !hasid) hasid = true;
                saveid += (saveid=='' ? saveids[i] : ','+saveids[i]);
                j++;
                if(j==20 && hasid) break;
                if(j==19 && !hasid) break;
            }
        }

        if(hasid)
        {
            $('#zanbox').addClass('zanbox-selected');
        }

    }

});

window.onload = function() {

    $('#sharediv').removeClass('bdshare-button-style1-32');
    $('#sharediv').attr('class','bdsharebuttonbox');
};
</script>
<script type="text/javascript" src="http://cdn.cocimg.com/cms/templets/js/shCore.js"></script>
    <script type="text/javascript" src="http://cdn.cocimg.com/cms/templets/js/brush.js"></script>
    <link type="text/css" rel="stylesheet" href="http://cdn.cocimg.com/cms/templets/style/shCoreDefault.css"/>
    <script type="text/javascript">
    //SyntaxHighlighter.config.clipboardSwf = '/js/scripts/clipboard.swf';

    SyntaxHighlighter.all();</script>


<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"Playground 快速原型制作 - 来自CocoaChina苹果开发中文站@CocoaChina","bdMini":"2","bdMiniList":false,"bdPic":"/cms/uploads/allimg/140927/4196-14092G613040-L.jpg","bdStyle":"1","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api//js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<!--./cont-->

<!-- 回复评论框模板 -->
<script type="text/javascript" src="http://cdn.cocimg.com/cms/templets/js/comment.js?v=20151019"></script>
<script type="text/javascript" src="http://cdn.cocimg.com/cms/templets/js/mustache.min.js"></script>
<!-- 回复评论框模板 -->
<script id="reply_comment_template" type="x-tmpl-mustache">
    <div id="sub-reply-comment" class="reply-comment">
        <textarea name="subcomment" id="sub-reply-txt" cols="30" rows="10" placeholder="你怎么看？快来评论一下吧！"></textarea>
        <input type="hidden" id="sub-reply-id" value="{{commentid}}" />
        <input type="hidden" id="sub-reply-userid" value="{{parentuserid}}" />
        <input type="hidden" id="sub-reply-username" value="{{parentusername}}" />
        <a type="button" id="sub_comment_bt" class="submitbt">提交</a>
        <div class="clearfloat"></div>
        <div class="unlogin-mask">
            <div>您还没有登录！请<a href="/bbs/login.php">登录</a>或<a href="/bbs/register.php">注册</a></div>
        </div>
    </div>
</script>

<!-- 评论模板 -->
<script id="main_comment_template" type="x-tmpl-mustache">
    <div class="glab-comment" rel-data-id="{{comment_id}}" rel-user-id="{{user_id}}" rel-user-name="{{user_name}}" rel-layer="1">
        <div class="comment-left">
            <a href="/bbs/u.php?action=feed&uid={{user_id}}" target="_blank"><img src="{{user_icon_url}}" height="43" width="43" alt=""></a>
        </div>
        <div class="comment-right">
            <div class="comment-author"><a href="/bbs/u.php?action=feed&uid={{user_id}}" target="_blank">{{user_name}}</a><span class="puptime">{{create_time}}</span></div>
            <div class="comment-content">{{&content}}</div>
            <div class="comment-buttons">
                <span class="ding">                    
                    <img src="http://cdn.cocimg.com/cms/templets/images/zan-default.png" height="14" width="14" alt="" class="default" style="{{#has_supported}} display:none; {{/has_supported}}">
                    <img src="http://cdn.cocimg.com/cms/templets/images/zan-active.png" height="14" width="14" alt="" class="actived" style="{{^has_supported}} display:none; {{/has_supported}}">
                    <span class="zancnt">{{support}}</span>
                </span>
                <span class="cai">
                    <img src="http://cdn.cocimg.com/cms/templets/images/cai-default.png" height="14" width="14" alt="" class="default" style="{{#has_reported}} display:none; {{/has_reported}}">
                    <img src="http://cdn.cocimg.com/cms/templets/images/cai-active.png" height="14" width="14" alt="" class="actived" style="{{^has_reported}} display:none; {{/has_reported}}">
                    <span class="zancnt">{{report}}</span>
                </span>
                <span class="replybt">回复</span>
            </div>
        </div>
            {{#sub}}
                <div class="glab-comment glab-sub-comment" rel-data-id="{{comment_id}}" rel-user-id="{{user_id}}" rel-user-name="{{user_name}}" rel-layer="2">
                    <div class="comment-left">
                        <a href="/bbs/u.php?action=feed&uid={{user_id}}" target="_blank"><img src="{{user_icon_url}}" height="43" width="43" alt=""></a>
                    </div>
                    <div class="comment-right">
                        <div class="comment-author"><a href="/bbs/u.php?action=feed&uid={{user_id}}" target="_blank">{{user_name}}</a><span class="puptime">{{create_time}}</span></div>
                        <div class="comment-content"><a href="/bbs/u.php?action=feed&uid={{parent_user_id}}" target="_blank">回复：{{parent}}</a>{{&content}}</div>
                        <div class="comment-buttons">
                            <span class="ding">
                                <img src="http://cdn.cocimg.com/cms/templets/images/zan-default.png" height="14" width="14" alt="" class="default" style="{{#has_supported}} display:none; {{/has_supported}}">
                                <img src="http://cdn.cocimg.com/cms/templets/images/zan-active.png" height="14" width="14" alt="" class="actived" style="{{^has_supported}} display:none; {{/has_supported}}">
                                <span class="zancnt">{{support}}</span>
                            </span>
                            <span class="cai">
                                <img src="http://cdn.cocimg.com/cms/templets/images/cai-default.png" height="14" width="14" alt="" class="default" style="{{#has_reported}} display:none; {{/has_reported}}">
                                <img src="http://cdn.cocimg.com/cms/templets/images/cai-active.png" height="14" width="14" alt="" class="actived" style="{{^has_reported}} display:none; {{/has_reported}}">
                                <span class="zancnt">{{report}}</span>
                            </span>
                            <span class="replybt">回复</span>
                        </div>          
                    </div>
                </div>
            {{/sub}}         
    </div>  
</script>


<script id="sub_comment_template" type="x-tmpl-mustache">
    <div class="glab-comment glab-sub-comment" rel-data-id="{{comment_id}}" rel-user-id="{{user_id}}" rel-user-name="{{user_name}}" rel-layer="2">
        <div class="comment-left">
            <a href="/bbs/u.php?action=feed&uid={{user_id}}" target="_blank"><img src="{{user_icon_url}}" height="43" width="43" alt=""></a>
        </div>
        <div class="comment-right">
            <div class="comment-author"><a href="/bbs/u.php?action=feed&uid={{user_id}}" target="_blank">{{user_name}}</a><span class="puptime">{{create_time}}</span></div>
            <div class="comment-content"><a href="/bbs/u.php?action=feed&uid={{parent_user_id}}" target="_blank">回复：{{parent}}</a>{{&content}}</div>
            <div class="comment-buttons">
                <span class="ding">
                    <img src="http://cdn.cocimg.com/cms/templets/images/zan-default.png" height="14" width="14" alt="" class="default" style="{{#has_supported}} display:none; {{/has_supported}}">
                    <img src="http://cdn.cocimg.com/cms/templets/images/zan-active.png" height="14" width="14" alt="" class="actived" style="{{^has_supported}} display:none; {{/has_supported}}">
                    <span class="zancnt">{{support}}</span>
                </span>
                <span class="cai">
                    <img src="http://cdn.cocimg.com/cms/templets/images/cai-default.png" height="14" width="14" alt="" class="default" style="{{#has_reported}} display:none; {{/has_reported}}">
                    <img src="http://cdn.cocimg.com/cms/templets/images/cai-active.png" height="14" width="14" alt="" class="actived" style="{{^has_reported}} display:none; {{/has_reported}}">
                    <span class="zancnt">{{report}}</span>
                </span>
                <span class="replybt">回复</span>
            </div>          
        </div>
    </div>
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68948817-1', 'auto', {'name': 'newTracker'});
  ga('newTracker.send', 'pageview');

</script>
</div>    
<!--右侧浮动-->
    <div class="r-bar">
        <img src="http://cdn.cocimg.com/cms/templets/images/coco_weixin.png" class="weixin">
    	<a href="http://weibo.com/cocoachina" target="_blank" title="" class="weibo">sina</a>
        <a href="javascript:void(0);" target="_blank" title="" class="feedback">weixin</a>
        <a href="mailto:support@cocoachina.com" title="" class="kefu">mail</a>
        <a href="javascript:;" title="回到顶部" class="returntop">回到顶部</a>
    </div>

<script language="javascript" src="/cms/bbsauth_plus2015.php" type="text/html"></script>
<script type="text/javascript">
$(function(){
    if (typeof(_user_info_html) != 'undefined' && _user_info_html)
    {
        $('.nav-user-login').hide();
        $('.nav-user-name').html(_user_info_html).show();
    }

	var type = $('#type_name').html();
	if(type)
	{	
		switch( type )
		{
			case 'iOS开发':
				$('#ios').addClass('light');
				break;
			case 'AppStore研究':
				$('#app_store').addClass('light');
				break;
			case 'Mac开发':
				$('#mac').addClass('light');
				break;
			case '产品设计':
				$('#design').addClass('light');
				break;
			case 'Cocos引擎':
				$('#cocos').addClass('light');
				break;
			case 'WebApp':
				$('#webapp').addClass('light');
				break;
			case 'Swift':
				$('#swift').addClass('light');
				break;
			case '游戏开发':
				$('#game').addClass('light');
				break;
			case '苹果相关':
				$('#apple').addClass('light');
				break;
			case '营销推广':
				$('#market').addClass('light');
				break;		
			case '业界动态':
				$('#industry').addClass('light');
				break;	
			case '程序人生':
				$('#programmer').addClass('light');
				break;																																
				
		}
	}
});
</script>
<!--./cont-->
<script type="text/javascript" src="/cms/templets/js/index.js?20111546514"></script>
<script src="http://cdn.cocimg.com/cms/templets/js/jquery.colorbox-min.js" type="text/javascript"></script>
<script src="/cms/templets/js/script.js?t=2045479411" type="text/javascript"></script>
<script type="text/javascript">
			jQuery(function()
			{
				//更改文章来源
				var source = $('#source a').html();								
				if( source == '未知' )
					jQuery('#source a').html('CocoaChina');
				if( jQuery('#source a').attr('href')=='')
					jQuery('#source').html('来源：'+source);
				
				//获取用户登录的id
//                var content = jQuery('.t-lid').attr("href");
//                var uid = 0;
//                if( content )
//                {
//                    content = content.split('=');
//                    uid = content[1];
//                }
//                var timestamp = new Date().getTime();	
//                var uid2 = parseInt(uid);
//                if(uid2==uid && uid2!=0){
//                    uid = uid<<2;			
//                    uid = uid+''+timestamp;
//                }else{
//                    uid = "";
//                }
//                var oIframe=document.getElementById("comiframe");
//                if(oIframe){
//                    var oUrl=window.location.href;
//                    oUrl = encodeURIComponent(oUrl);
//
//                    oIframe.src="/comment.php?url="+oUrl+"&uid="+uid;
//                }

				
			});
		</script>
<!--footer-->
<div class="footer clearfix">
    <div class="footer-b">
        <div>
            <a href="/aboutus/index.html" target="_blank">关于我们</a>
            <a href="/contactus/index.html" target="_blank">商务合作</a>
            <a href="mailto:support@cocoachina.com" target="_blank">联系我们</a>
            <a href="/corps" target="_blank">合作伙伴</a>
        </div>
        <p class="footer-b-p">北京触控科技有限公司版权所有</p>
        <p>
            &copy;2016 Chukong Technologies,Inc.
            <i>
                <a href="http://www.miibeian.gov.cn/" target="_blank">京ICP备 11006519号 　京ICP证 100954号</a> 京公网安备11010502020289 
                <a href="http://182.131.21.137/ccnt-apply/admin/business/preview/business-preview!lookUrlRFID.action?main_id=A580B24B1AE846CE9DA949026D63939F" target="_blank">
                    <img src="http://cdn.cocimg.com/cms/templets/images/jingwen.png" style="margin: -10px auto -14px -10px;" />
                    京网文[2012]0426-138号
                </a>
            </i>
        </p>
    </div>
</div>
<!--./footer-->
<script language="javascript" type="text/javascript" src="/cms/include/dedeajax2-min.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?88399e4c4cf744609c4fc8c3a8935691";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-16940817-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  
 
function search_check()
{
	var search_keyword = $('#search_keyword').val();

	if( search_keyword.length < 2 )
	{
		alert("搜索关键字不能少于2个字节，请重新输入。");
	}
	else
	{
		$('#searchform').submit();
	}
}

</script>
<script type="text/javascript">
_acK({aid:116313,format:0,mode:1,gid:1,serverbaseurl:"afp.csbew.com/"});
</script>

</body>
</html>
